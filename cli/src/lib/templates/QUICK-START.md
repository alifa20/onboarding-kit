# Template System Quick Start

## Overview

The OnboardKit template system generates production-ready TypeScript/React Native code from validated specifications.

## Basic Usage

```typescript
import { renderTemplates } from './lib/templates';
import type { OnboardingSpec } from './lib/spec/schema';

// Assume you have a validated spec
const spec: OnboardingSpec = { /* ... */ };

// Render all templates
const result = await renderTemplates(spec);

// Access generated files
for (const file of result.files) {
  console.log(`${file.path}:`);
  console.log(file.content);
}

// View summary
console.log(`Generated ${result.summary.totalFiles} files`);
console.log(`- ${result.summary.screens} screens`);
console.log(`- ${result.summary.components} components`);
console.log(`- ${result.summary.themeFiles} theme files`);
console.log(`- ${result.summary.navigationFiles} navigation files`);
```

## Generated File Structure

```
output/
├── screens/
│   ├── WelcomeScreen.tsx          # Welcome screen with CTA
│   ├── OnboardingStep1Screen.tsx  # First onboarding step
│   ├── OnboardingStep2Screen.tsx  # Second step (if present)
│   ├── LoginScreen.tsx             # Login/auth screen
│   ├── NameCaptureScreen.tsx       # Signup/name capture
│   └── HomeScreen.tsx              # Placeholder home
├── components/
│   ├── Button.tsx                  # Reusable button component
│   ├── Input.tsx                   # Text input component
│   └── Card.tsx                    # Card container
├── navigation/
│   ├── stack.tsx                   # Navigation stack setup
│   └── types.ts                    # Navigation type definitions
└── theme/
    ├── colors.ts                   # Color palette
    ├── typography.ts               # Font styles
    ├── spacing.ts                  # Spacing scale
    └── index.ts                    # Theme exports
```

## Template Context

The context builder creates a data structure from your spec:

```typescript
interface TemplateContext {
  projectName: string;
  theme: Theme;
  welcome: WelcomeScreen;
  onboardingSteps: OnboardingStep[];
  login: Login;
  nameCapture: NameCapture;

  // Computed flags
  hasGoogle: boolean;
  hasApple: boolean;
  hasEmail: boolean;
  totalSteps: number;

  // Screen names for navigation
  screens: {
    welcome: 'WelcomeScreen';
    onboardingSteps: ['OnboardingStep1Screen', ...];
    login: 'LoginScreen';
    // etc.
  };
}
```

## Available Handlebars Helpers

### String Transformations
```handlebars
{{pascalCase "hello world"}}    → HelloWorld
{{camelCase "hello world"}}     → helloWorld
{{kebabCase "Hello World"}}     → hello-world
```

### Conditionals
```handlebars
{{#if (eq method "email")}}
  Email login enabled
{{/if}}

{{#if (includes methods "google")}}
  Google login enabled
{{/if}}
```

### Array Operations
```handlebars
{{join array ", "}}             → "a, b, c"
{{inc @index}}                  → index + 1

{{#each items}}
  {{#if (isLast @index ../items)}}
    Last item!
  {{/if}}
{{/each}}
```

## Adding New Templates

1. Create `.hbs` file in appropriate directory:
   - `handlebars/screens/` - Screen templates
   - `handlebars/components/` - Component templates
   - `handlebars/theme/` - Theme templates

2. Use Handlebars syntax with context:
```handlebars
/**
 * {{screenName}} for {{projectName}}
 * Generated by OnboardKit
 */

import React from 'react';
import { View, Text, StyleSheet } from 'react-native';
import { colors, typography } from '../theme';

export function {{screenName}}() {
  return (
    <View style={styles.container}>
      <Text style={styles.title}>{{headline}}</Text>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    backgroundColor: colors.background,
  },
  title: {
    ...typography.h1,
    color: colors.text,
  },
});
```

3. Register in `renderer.ts`:
```typescript
const template = await loadTemplate('screens/new-screen.hbs');
const rendered = template(context);
const formatted = await formatCode(rendered);
files.push({
  path: 'screens/NewScreen.tsx',
  content: formatted,
});
```

## Code Quality Checks

Generated code is automatically:
- ✅ Formatted with Prettier
- ✅ TypeScript strict mode compatible
- ✅ ESLint compliant
- ✅ React Native compatible

All imports are relative and properly typed.

## Testing Templates

```typescript
import { renderTemplates } from './renderer';

const mockSpec: OnboardingSpec = {
  projectName: 'TestApp',
  theme: { primary: '#6C5CE7', /* ... */ },
  // ... rest of spec
};

const result = await renderTemplates(mockSpec);

// Assert files are generated
expect(result.files.length).toBeGreaterThan(0);

// Assert content is correct
const welcomeFile = result.files.find(f => f.path === 'screens/WelcomeScreen.tsx');
expect(welcomeFile?.content).toContain('WelcomeScreen');
expect(welcomeFile?.content).toContain('TestApp');
```

## Common Patterns

### Conditional Rendering
```handlebars
{{#if hasGoogle}}
  // Google-specific code
{{/if}}

{{#if hasSoftPaywall}}
  // Paywall navigation
{{else}}
  // Direct to login
{{/if}}
```

### Looping Over Arrays
```handlebars
{{#each onboardingSteps}}
  <Step{{inc @index}}Screen />
{{/each}}
```

### Dynamic Values
```handlebars
<Text style={styles.headline}>{{welcome.headline}}</Text>

const styles = StyleSheet.create({
  primary: {
    backgroundColor: '{{theme.primary}}',
  },
});
```

## Debugging

Enable verbose mode to see what's happening:

```typescript
const result = await renderTemplates(spec);

// Check what was generated
console.log(JSON.stringify(result.summary, null, 2));

// Inspect a specific file
const file = result.files.find(f => f.path === 'screens/WelcomeScreen.tsx');
console.log(file?.content);
```

## Performance

- Template compilation is cached by Handlebars
- Prettier formatting runs in parallel where possible
- Average generation time: <1 second for full spec
- Memory usage: <50MB for typical specs

## Next Steps

After generating code:

1. Copy files to your Expo project:
   ```bash
   cp -r output/* my-expo-app/src/
   ```

2. Install dependencies:
   ```bash
   npm install @react-navigation/native @react-navigation/native-stack
   npx expo install react-native-screens react-native-safe-area-context
   ```

3. Replace placeholder images in `assets/`

4. Start dev server:
   ```bash
   npx expo start
   ```

## Troubleshooting

**Templates not rendering?**
- Check spec is validated before rendering
- Verify template file path is correct
- Check context data structure

**TypeScript errors in generated code?**
- Ensure spec has all required fields
- Check template syntax for missing imports
- Verify StyleSheet.create usage

**Prettier formatting fails?**
- Check for syntax errors in template
- Verify balanced brackets/parentheses
- Falls back to unformatted code on error

## Support

See main README for full documentation and examples.
